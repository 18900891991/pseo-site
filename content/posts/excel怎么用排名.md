---
title: "excel怎么用排名"
date: 2026-02-07T08:17:23.738967+08:00
description: "Excel 排名（Rank）使用全攻略  在数据分析、成绩统计、销售排行等情境中，往往需要对一组数值进行排序并给出排名。Excel 提供了多种函数与工具来完成这一任务，本文将从原因、三种常用实现方式以及常见问题三大角度，为你详细阐述如何在 Excel 中使用排名。"
draft: false
categories: ["AI教程"]
---

# Excel 排名（Rank）使用全攻略

在数据分析、成绩统计、销售排行等情境中，往往需要对一组数值进行排序并给出排名。Excel 提供了多种函数与工具来完成这一任务，本文将从**原因**、**三种常用实现方式**以及**常见问题**三大角度，为你详细阐述如何在 Excel 中使用排名。

> 你不需要额外的插件或宏，只需要 Excel 自带的函数或排序工具即可实现排名。

---

## 1. 为什么需要排名？

| 场景 | 排名的作用 |
|------|-----------|
| **成绩统计** | 直观展示学生或员工的相对表现，便于评估优劣。 |
| **销售排行** | 识别销售冠军、潜在问题区域，制定激励措施。 |
| **数据筛选** | 取前 N / 后 N 名数据，用于后续分析。 |
| **竞品对比** | 对比各品牌、产品的市场份额或评分。 |

> **核心优势**  
> - **可视化**：排名一目了然，省去手动排序的繁琐。  
> - **动态更新**：只需修改原始数据，排名自动刷新。  
> - **兼容性**：支持多种排序规则（升序/降序、唯一/重复、空值处理等）。

---

## 2. 方案一：使用 `RANK.EQ` / `RANK.AVG` 函数

### 2.1 基础公式

| 函数 | 语法 | 说明 |
|------|------|------|
| `RANK.EQ(number, ref, [order])` | `=RANK.EQ(A2,$A$2:$A$10,0)` | 对 `A2` 的数值在 `A2:A10` 范围内进行排名，`order=0` 为降序（最高值为 1）。 |
| `RANK.AVG(number, ref, [order])` | `=RANK.AVG(A2,$A$2:$A$10,0)` | 同样排名，但若出现重复值则给出平均排名。 |

### 2.2 分步操作

1. **准备数据**  
   在 `A` 列放置需要排名的数值，例如：成绩、销量。

2. **输入公式**  
   在 `B2` 输入：`=RANK.EQ(A2,$A$2:$A$10,0)`，按 Enter。

3. **复制公式**  
   将 `B2` 向下填充至对应行数，得到完整的排名列表。

4. **（可选）处理重复值**  
   若想让重复值获得相同排名，可以改用 `RANK.AVG`；如果想让重复值排名不相同但顺序一致，可使用 `RANK.EQ` 并配合 `+` 公式调整。

### 2.3 注意事项

- **空值**：公式会忽略空单元格，但会将空单元格的排名设为 0。  
- **负数**：排名会按大小处理，负数会被视为低于 0。  
- **升序**：把 `order` 设为 `1` 即可实现升序排名。

---

## 3. 方案二：使用 `SORT` + `UNIQUE` + `SEQUENCE`（Excel 365 / 2019+）

此方法不使用传统排名函数，而是通过排序+序列生成实现动态排名，适合需要显示完整排名列表并同步更新的场景。

### 3.1 准备公式

```excel
=SORT(A2:A10, 1, -1)          // 升序或降序排序
=SEQUENCE(COUNT(A2:A10))      // 生成 1..N 的序列
=UNIQUE(SORT(A2:A10,1,-1))   // 去重后排序
```

### 3.2 分步操作

1. **排序**  
   在 `B2` 输入：`=SORT(A2:A10,1,-1)`，得到降序排列的数值。

2. **生成排名序列**  
   在 `C2` 输入：`=SEQUENCE(COUNT(A2:A10))`，得到 1,2,3… 的序列。

3. **合并**  
   在 `D2` 通过 `INDEX` 或 `VLOOKUP` 把数值与排名对应，例如 `=INDEX($C$2:$C$10, MATCH(B2,$B$2:$B$10,0))`。

4. **（可选）去重**  
   若需要平均排名或唯一排名，可在 `B2` 使用 `UNIQUE(SORT(...))` 并相应调整 `SEQUENCE`。

### 3.3 优点

- **自动更新**：当原始数据变动时，排名列表会实时刷新。  
- **可视化**：可以直接显示在表头或侧栏中，便于对齐。  
- **灵活**：支持多列排名、条件过滤后排名等。

---

## 4. 方案三：使用 `PERCENT_RANK` 与 `PERCENTILE.EXC`

在需要对排名进行百分比/百分位数展示时，`PERCENT_RANK` 与 `PERCENTILE.EXC` 可以提供更细粒度的相对位置。

### 4.1 基础公式

| 函数 | 语法 | 说明 |
|------|------|------|
| `PERCENT_RANK(array, x, [significance])` | `=PERCENT_RANK($A$2:$A$10, A2, 3)` | 计算 `A2` 在 `A2:A10` 内的百分比排名（0-1 之间）。 |
| `PERCENTILE.EXC(array, k)` | `=PERCENTILE.EXC($A$2:$A$10, 0.75)` | 计算第 75% 分位数对应的数值。 |

### 4.2 分步操作

1. **计算百分比排名**  
   在 `B2` 输入：`=PERCENT_RANK($A$2:$A$10, A2, 3)`，四舍五入到 3 位小数。

2. **转换为 1~N 排名**  
   通过 `=ROUNDUP(B2*COUNT($A$2:$A$10), 0)` 或 `=RANK.EQ(A2,$A$2:$A$10,0)` 结合使用。

3. **可视化**  
   在图表或条件格式化中使用百分比排名突出高/低区间。

### 4.3 适用场景

- **分布分析**：了解数据的分布情况。  
- **异常值识别**：极端值往往对应极低或极高的百分比排名。  
- **报告输出**：往往需要“排名前 10%”等表达。

---

## 5. 常见问题解答

| # | 问题 | 解决方案 |
|---|------|----------|
| 1 | **为什么 `RANK.EQ` 产生重复排名？** | `RANK.EQ` 对相同数值给出相同排名，随后排名会跳过。例如，数值 100 有 3 个，排名为 1、1、1，下一位为 4。若想连号排名，使用 `RANK.AVG` 或自定义公式 `=RANK.EQ(A2,$A$2:$A$10,0)+COUNTIF($A$2:A2,A2)-1`。 |
| 2 | **如何对空值或文本进行排名？** | 先将空值或文本转换为数值（可使用 `IFERROR` 或 `IF` 处理），或者在公式中使用 `IF(ISNUMBER(A2), RANK.EQ(...), "")`。 |
| 3 | **怎样实现升序排名？** | 将 `order` 参数设为 `1`：`=RANK.EQ(A2,$A$2:$A$10,1)`。 |
| 4 | **想要排名从 0 开始吗？** | 在 `RANK.EQ` 之后减 1：`=RANK.EQ(A2,$A$2:$A$10,0)-1`。 |
| 5 | **排名要排除前 N 名吗？** | 使用 `FILTER` 函数先筛选前 N 名，再用 `RANK.EQ`：`=RANK.EQ(A2,FILTER($A$2:$A$10,$A$2:$A$10>=LARGE($A$2:$A$10,N)))`。 |
| 6 | **如何在同一列内显示数值和排名？** | 在相邻列使用 `=A2 & " (" & RANK.EQ(A2,$A$2:$A$10,0) & ")"`。 |
| 7 | **为什么 `PERCENT_RANK` 返回 0.0？** | 数据集太小或所有值相同。可尝试 `PERCENT_RANK(array, x, 0)` 或 `=IF(COUNT(array)=1,1, ...)`。 |
| 8 | **Excel 2016 没有 `SORT` 函数怎么办？** | 使用 `SMALL` / `LARGE` + `INDEX`：`=INDEX($A$2:$A$10, MATCH(SMALL($A$2:$A$10,ROW(A1)), $A$2:$A$10,0))`。 |

---

## 6. 小结

- **RANK.EQ / RANK.AVG**：适合传统排名需求，易用、兼容性好。  
- **SORT + SEQUENCE**：适用于动态数据、需要完整排序列表的高级场景。  
- **PERCENT_RANK**：提供百分位数视角，适合分布分析。  

根据自己的数据量、版本以及输出需求，任选一种方案即可轻松完成 Excel 排名。祝你工作顺利，数据分析事半功倍！